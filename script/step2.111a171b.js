(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{180:function(e,t,a){e.exports=a(298)},297:function(e,t,a){},298:function(e,t,a){e.exports=a(299)},299:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),c=a(13),o=a.n(c),l=a(2),s=a.n(l),i=a(0),u=a.n(i),g=a(3),d=a.n(g),v=a(8),b=a.n(v),f=a(4),p=a.n(f),h=a(14),m=a.n(h),_=a(22),y=a.n(_),w=a(33),S=a.n(w),x=a(52),k=a.n(x),E=a(53),A=a.n(E),q=a(15),L=a.n(q),C=a(24),I=a.n(C),D=a(51),N=a.n(D);function O(e,t){var a=m()(e);if(p.a){var n=p()(e);t&&(n=b()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a,n=null!=arguments[t]?arguments[t]:{};if(t%2)u()(a=O(Object(n),!0)).call(a,(function(t){L()(e,t,n[t])}));else if(s.a)o()(e,s()(n));else{var c;u()(c=O(Object(n))).call(c,(function(t){r()(e,t,d()(n,t))}))}}return e}var J,M,T,z,B,F=(J={},M={current:"current"},T=function(e){var t,a=e.currentTarget,n=this.config.get(J),r=n.root,c=n.tabs,o=n.activeClass,l=r.querySelector(".".concat(o)),s=N()(t=I()(c)).call(t,a);a.classList.contains(o)||(l&&(l.classList.remove(o),l.setAttribute("aria-expanded","false"),l.setAttribute("aria-disabled","false"),l.nextElementSibling.hidden=!0),a.classList.add(o),a.setAttribute("aria-expanded","true"),a.setAttribute("aria-disabled","true"),a.nextElementSibling.hidden=!1,this.currentIdx.set(M,s),z(a,"selected",{activatedIdx:s,activateEl:a}))},z=function(e,t,a){var n,r={detail:j({},a),bubbles:!0,cancelable:!0};"function"==typeof window.CustomEvent?n=new CustomEvent(t,r):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r.detail),e.dispatchEvent(n)},B=function(e){e.currentTarget;var t,a=e.keyCode||e.which,n=this.config.get(J).tabs,r=this.currentIdx.get(M);switch(a){case 37:case 38:e.preventDefault(),n[t=--r<0?n.length-1:r].focus(),this.currentIdx.set(M,t);break;case 39:case 40:e.preventDefault(),n[t=++r>n.length-1?0:r].focus(),this.currentIdx.set(M,t)}},function(){function e(t){if(k()(this,e),!t.root)throw new Error("'root' is not defined");var a=j({activeClass:"activated"},t);this.config=new S.a,this.currentIdx=new S.a([[M,0]]),this.config.set(J,a),this.init()}return A()(e,[{key:"init",value:function(){for(var e,t,a=this.config.get(J),n=a.tabs,r=a.panels,c=a.activeClass,o=-1;e=n[++o];)(t=r[o]).setAttribute("role","group"),t.setAttribute("aria-describedby",e.id),e.setAttribute("aria-controls",t.id),0!=o?(e.nextElementSibling.hidden=!0,e.setAttribute("aria-expanded","false"),e.setAttribute("aria-disabled","false")):(e.classList.add(c),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-disabled","true")),e.addEventListener("click",y()(T).call(T,this),!1),e.addEventListener("keydown",y()(B).call(B,this),!1);this.currentIdx.set(M,0),z(n[0],"selected",{activatedIdx:0,activateEl:n[0]})}}]),e}());t.default=F},359:function(e,t,a){"use strict";a.r(t);a(255),a(256),a(153),a(276);var n=a(22),r=a.n(n),c=a(38),o=a.n(c),l=a(178),s=a.n(l),i=a(179),u=a.n(i),g=a(8),d=a.n(g),v=a(29),b=a.n(v),f=a(19),p=a.n(f),h=a(24),m=a.n(h),_=a(0),y=a.n(_),w=(a(297),a(54),a(55),a(180)),S=a.n(w),x=a(7),k=[{bg:[{class:"ct1-bg-1",name:"밝은 옥색"},{class:"ct1-bg-2",name:"파우더 블루"},{class:"ct1-bg-3",name:"밝은 분홍"}],groupa:[{class:"ct1-groupa-1",name:"비버색"},{class:"ct1-groupa-2",name:"버번색"},{class:"ct1-groupa-3",name:"호두색"}],groupb:[{class:"ct1-groupb-1",name:"오뜨 핑크"},{class:"ct1-groupb-2",name:"딥 블러쉬"},{class:"ct1-groupb-3",name:"등나무 꽃색"}],groupc:[{class:"ct1-groupc-1",name:"라벤더"},{class:"ct1-groupc-2",name:"버터색"},{class:"ct1-groupc-3",name:"스위트 로즈"}]},{bg:[{class:"ct2-bg-1",name:"밝은 에버그린"},{class:"ct2-bg-2",name:"블리자드 블루"},{class:"ct2-bg-3",name:"버터"}],groupa:[{class:"ct2-groupa-1",name:"하늘색"},{class:"ct2-groupa-2",name:"블루베리"},{class:"ct2-groupa-3",name:"레몬"}],groupb:[{class:"ct2-groupb-1",name:"연한 덩쿨장미 색"},{class:"ct2-groupb-2",name:"버터 크림색"},{class:"ct2-groupb-3",name:"하늘색"}],groupc:[{class:"ct2-groupc-1",name:"비너스 핑크"},{class:"ct2-groupc-2",name:"복숭아 색"},{class:"ct2-groupc-3",name:"짙은 적갈색"}]}],E=x.a.getData(["design"]).design;void 0===E&&location.replace("index.html"),x.a.resetSelectedItems(["colors"]);var A=document.querySelector(".next-step"),q=function(e){if(!e)throw new Error("DrawCanvas is not defined");var t=e,a=e.querySelectorAll('[name="draw-bg"].coloring__checkbox + .coloring__button'),n=e.querySelectorAll('[name="draw-groupa"].coloring__checkbox + .coloring__button'),c=e.querySelectorAll('[name="draw-groupb"].coloring__checkbox + .coloring__button'),l=e.querySelectorAll('[name="draw-groupc"].coloring__checkbox + .coloring__button'),i=e.querySelectorAll('input[type="radio"]'),g=e.querySelector(".canvas__layer--color-bg"),v=e.querySelector(".canvas__layer--color-groupa"),f=e.querySelector(".canvas__layer--color-groupb"),h=e.querySelector(".canvas__layer--color-groupc"),_=e.querySelectorAll('[class*="canvas__layer--sketch-"]'),w=function(e,t){var a,n,r,c,o=t.currentTarget,l=o.getAttribute("name").replace("draw-",""),s=1*o.value+1;switch(l){case"bg":g.src=b()(a="images/ct".concat(e+1,"_bg_")).call(a,Number(s-1),".svg");break;case"groupa":v.src=b()(n="images/ct".concat(e+1,"_1_")).call(n,Number(s-1),".svg");break;case"groupb":f.src=b()(r="images/ct".concat(e+1,"_2_")).call(r,Number(s-1),".svg");break;case"groupc":h.src=b()(c="images/ct".concat(e+1,"_3_")).call(c,Number(s-1),".svg")}if(S(i).length>=4){var u=!0,d=!1,m=void 0;try{for(var y,w=p()(_);!(u=(y=w.next()).done);u=!0){y.value.classList.remove("dehighlight")}}catch(e){d=!0,m=e}finally{try{u||null==w.return||w.return()}finally{if(d)throw m}}}},S=function(e){var t,a;e=e||i;var n={length:0};return y()(t=d()(a=m()(e)).call(a,(function(e){return e.checked}))).call(t,(function(e){n[e.name.replace("draw-","")]=1*e.value,n.length+=1})),n};return{init:function(e){var g;!function(e){var r,o,s,i;if(void 0===e)throw new Error("[DrawColor] design is not defined");var u="images/ct".concat(e+1,"_bg_0_0.svg"),g="images/ct".concat(e+1,"_bg_0_1.svg"),d="images/ct".concat(e+1,"_bg_0_2.svg"),v="images/ct".concat(e+1,"_bg_0_3.svg");t.querySelector(".canvas__layer--sketch-bg").src=u,t.querySelector(".canvas__layer--sketch-groupa").src=g,t.querySelector(".canvas__layer--sketch-groupb").src=d,t.querySelector(".canvas__layer--sketch-groupc").src=v,y()(r=m()(a)).call(r,(function(t,a){t.classList.add("coloring__button--".concat(k[e].bg[a].class))})),y()(o=m()(n)).call(o,(function(t,a){t.classList.add("coloring__button--".concat(k[e].groupa[a].class))})),y()(s=m()(c)).call(s,(function(t,a){t.classList.add("coloring__button--".concat(k[e].groupb[a].class))})),y()(i=m()(l)).call(i,(function(t,a){t.classList.add("coloring__button--".concat(k[e].groupc[a].class))}));var b=!0,f=!1,h=void 0;try{for(var w,S=p()(_);!(b=(w=S.next()).done);b=!0){w.value.classList.add("dehighlight")}}catch(e){f=!0,h=e}finally{try{b||null==S.return||S.return()}finally{if(f)throw h}}}(e);for(var d,v=u()(g=s()(k[e])).call(g),b=function(t,a){o()((function(){a.checked=!1}),10),a.nextElementSibling.setAttribute("aria-label",v[t].name),a.addEventListener("change",r()(w).call(w,null,e),!1)},f=-1;d=i[++f];)b(f,d)},highlightLayer:function(e){var t=e.detail.activateEl.id.replace(/draw\-|-legend/g,"");Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var a=!0,n=!1,r=void 0;try{for(var c,o=p()(_);!(a=(c=o.next()).done);a=!0){var l=c.value;l.matches(".canvas__layer--sketch-".concat(t))?l.classList.remove("dehighlight"):S(i).length<4&&l.classList.add("dehighlight")}}catch(e){n=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}},validate:function(e){return 4==S(i).length},getChecked:S}}(document.querySelector(".canvas__container"));q.init(E);var L=document.querySelector(".coloring-accordion");L.addEventListener("selected",q.highlightLayer,!1);new S.a({root:L,tabs:document.querySelectorAll(".coloring-accordion__tab"),panels:document.querySelectorAll(".coloring-accordion__panel .coloring__list"),activeClass:"active"});A.addEventListener("click",(function(e){if(!q.validate())return e.preventDefault(),void alert("색을 모두 칠하지 않으셨어요~");var t=q.getChecked(),a=t.bg,n=t.groupa,r=t.groupb,c=t.groupc;x.a.setSelectedColor({bg:a,groupa:n,groupb:r,groupc:c})}),!1)},7:function(e,t,a){"use strict";var n=a(12),r=a.n(n),c=a(13),o=a.n(c),l=a(2),s=a.n(l),i=a(0),u=a.n(i),g=a(3),d=a.n(g),v=a(8),b=a.n(v),f=a(4),p=a.n(f),h=a(14),m=a.n(h),_=a(19),y=a.n(_),w=a(15),S=a.n(w),x=a(18),k=a.n(x);function E(e,t){var a=m()(e);if(p.a){var n=p()(e);t&&(n=b()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a,n=null!=arguments[t]?arguments[t]:{};if(t%2)u()(a=E(Object(n),!0)).call(a,(function(t){S()(e,t,n[t])}));else if(s.a)o()(e,s()(n));else{var c;u()(c=E(Object(n))).call(c,(function(t){r()(e,t,d()(n,t))}))}}return e}var q=JSON.parse(sessionStorage.getItem("customed-oreo"))||{},L=function(e){sessionStorage.setItem("customed-oreo",k()(e))},C={clear:function(){sessionStorage.removeItem("customed-oreo")},getData:function(){return q},setSelectedDesign:function(e){return q=A({},q,{design:e}),L(q),q},setSelectedColor:function(e){return q=A({},q,{colors:e}),L(q),q},setMesssage:function(e){return q=A({},q,{message:e}),L(q),q},resetSelectedItems:function(e){var t=!0,a=!1,n=void 0;try{for(var r,c=y()(e);!(t=(r=c.next()).done);t=!0){var o=r.value;delete q[o]}}catch(e){a=!0,n=e}finally{try{t||null==c.return||c.return()}finally{if(a)throw n}}return L(q),q}};t.a=C}},[[359,1,0]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2NyaXB0cy9BY2NvcmRpb24vaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmlwdHMvQWNjb3JkaW9uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2NyaXB0cy9BY2NvcmRpb24vc3JjL0FjY29yZGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2NyaXB0cy9TdG9yZS9jb2xvckxpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmlwdHMvc3RlcDIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmlwdHMvU3RvcmUvaW5kZXguanMiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJzZXR0aW5ncyIsImN1cnJlbnQiLCJhY3RpdmF0ZSIsImVtaXRFdmVudCIsImJpbmRIZWFkZXJLZXlFdmVudCIsIkFjY29yZGlvbiIsImV2ZW50IiwiZWwiLCJjdXJyZW50VGFyZ2V0IiwidGhpcyIsImNvbmZpZyIsImdldCIsInJvb3QiLCJ0YWJzIiwiYWN0aXZlQ2xhc3MiLCJjdXJyQWN0aXZhdGVkRWwiLCJxdWVyeVNlbGVjdG9yIiwiY3VycklkeCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwic2V0QXR0cmlidXRlIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiaGlkZGVuIiwiYWRkIiwiY3VycmVudElkeCIsInNldCIsImFjdGl2YXRlZElkeCIsImFjdGl2YXRlRWwiLCJkZXRhaWwiLCJjdXN0b21FdmVudCIsInBhcmFtcyIsImJ1YmJsZXMiLCJjYW5jZWxhYmxlIiwid2luZG93IiwiQ3VzdG9tRXZlbnQiLCJkb2N1bWVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsIm5leHRJZHgiLCJrZXljb2RlIiwia2V5Q29kZSIsIndoaWNoIiwicHJldmVudERlZmF1bHQiLCJsZW5ndGgiLCJmb2N1cyIsIm9wdGlvbnMiLCJFcnJvciIsImluaXQiLCJ0YWIiLCJwYW5lbCIsInBhbmVscyIsImkiLCJpZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzcyIsIm5hbWUiLCJkZXNpZ24iLCJzdG9yZSIsImdldERhdGEiLCJ1bmRlZmluZWQiLCJsb2NhdGlvbiIsInJlcGxhY2UiLCJyZXNldFNlbGVjdGVkSXRlbXMiLCJuZXh0U3RlcEJ0biIsImRyYXdDb2xvciIsImJnQ29sb3JCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsImdyb3VwQUNvbG9yQnV0dG9ucyIsImdyb3VwQkNvbG9yQnV0dG9ucyIsImdyb3VwQ0NvbG9yQnV0dG9ucyIsImNoZWNrYm94ZXMiLCJiZ0ltZyIsImdyb3VwQUltZyIsImdyb3VwQkltZyIsImdyb3VwQ0ltZyIsInNrZXRjaExheWVycyIsImhhbmRsZUNvbG9yQ2hlY2siLCJjYXRlZ29yeSIsImdldEF0dHJpYnV0ZSIsInZhbHVlIiwic3JjIiwiTnVtYmVyIiwiZ2V0Q2hlY2tlZCIsInRhcmdldCIsIm9iaiIsIml0ZW0iLCJjaGVja2VkIiwic2tldGNoUGF0aCIsImdyb3VwQVBhdGgiLCJncm91cEJQYXRoIiwiZ3JvdXBDUGF0aCIsImVsZW0iLCJpZHgiLCJjb2xvckxpc3QiLCJsb2FkRGVmYXVsdFNrZXRjaGVzIiwiY2hlY2tib3giLCJjb2xvcnMiLCJoaWdobGlnaHRMYXllciIsImFjdGl2YXRlZCIsIkVsZW1lbnQiLCJwcm90b3R5cGUiLCJtYXRjaGVzIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJsYXllciIsInZhbGlkYXRlIiwiRHJhd0NvbG9yIiwiYWNjb3JkaW9uUm9vdCIsImFsZXJ0IiwiYmciLCJncm91cGEiLCJncm91cGIiLCJncm91cGMiLCJzZXRTZWxlY3RlZENvbG9yIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsInVwZGF0ZVN0b3JlIiwic2V0SXRlbSIsImNsZWFyIiwicmVtb3ZlSXRlbSIsInNldFNlbGVjdGVkRGVzaWduIiwic2V0TWVzc3NhZ2UiLCJtZXNzYWdlIiwiaXRlbXMiXSwibWFwcGluZ3MiOiI2RUFBQUEsRUFBT0MsUUFBVUMsRUFBUSxNLDBDQ0F6QkYsRUFBT0MsUUFBVUMsRUFBUSxNLCtyQkNBekIsSUFDTUMsRUFDQUMsRUFFRUMsRUE2QkFDLEVBbUJBQyxFQXBERkMsR0FDQUwsRUFBVyxHQUNYQyxFQUFVLENBQUNBLFFBQVMsV0FFbEJDLEVBQVcsU0FBU0ksR0FBTyxNQUN6QkMsRUFBS0QsRUFBTUUsY0FEYyxFQU0zQkMsS0FBS0MsT0FBT0MsSUFBSVgsR0FIbEJZLEVBSDZCLEVBRzdCQSxLQUNBQyxFQUo2QixFQUk3QkEsS0FDQUMsRUFMNkIsRUFLN0JBLFlBRUlDLEVBQWtCSCxFQUFLSSxjQUFMLFdBQXVCRixJQUN6Q0csRUFBVSxVQUFXSixJQUFYLE9BQXlCTixHQUV0Q0EsRUFBR1csVUFBVUMsU0FBU0wsS0FDdEJDLElBQ0RBLEVBQWdCRyxVQUFVRSxPQUFPTixHQUNqQ0MsRUFBZ0JNLGFBQWhCLHlCQUNBTixFQUFnQk0sYUFBaEIseUJBQ0FOLEVBQWdCTyxtQkFBbUJDLFFBQVMsR0FFOUNoQixFQUFHVyxVQUFVTSxJQUFJVixHQUNqQlAsRUFBR2MsYUFBSCx3QkFDQWQsRUFBR2MsYUFBSCx3QkFDQWQsRUFBR2UsbUJBQW1CQyxRQUFTLEVBRS9CZCxLQUFLZ0IsV0FBV0MsSUFBSXpCLEVBQVNnQixHQUM3QmQsRUFBVUksRUFBRCxXQUFpQixDQUN4Qm9CLGFBQWNWLEVBQ2RXLFdBQVlyQixNQUlWSixFQUFZLFNBQUNJLEVBQUlELEVBQU91QixHQUM1QixJQUFJQyxFQUNFQyxFQUFTLENBQ2JGLE9BQVEsRUFBRixHQUNEQSxHQUVMRyxTQUFTLEVBQ1RDLFlBQVksR0FFb0IsbUJBQXZCQyxPQUFPQyxZQUNoQkwsRUFBYyxJQUFJSyxZQUFZN0IsRUFBT3lCLElBRXJDRCxFQUFjTSxTQUFTQyxZQUFZLGdCQUN2QkMsZ0JBQWdCaEMsR0FBTyxHQUFNLEVBQU15QixFQUFPRixRQUd4RHRCLEVBQUdnQyxjQUFjVCxJQUdiMUIsRUFBcUIsU0FBU0UsR0FDdkJBLEVBQU1FLGNBQWpCLElBTUlnQyxFQUxFQyxFQUFVbkMsRUFBTW9DLFNBQVdwQyxFQUFNcUMsTUFFckM5QixFQUNFSixLQUFLQyxPQUFPQyxJQUFJWCxHQURsQmEsS0FFRUksRUFBVVIsS0FBS2dCLFdBQVdkLElBQUlWLEdBRWxDLE9BQU93QyxHQUNMLEtBQUssR0FDTCxLQUFLLEdBQ0huQyxFQUFNc0MsaUJBRU4vQixFQURBMkIsSUFBWXZCLEVBQVUsRUFBSUosRUFBS2dDLE9BQVMsRUFBSTVCLEdBQzlCNkIsUUFDZHJDLEtBQUtnQixXQUFXQyxJQUFJekIsRUFBU3VDLEdBQzdCLE1BQ0YsS0FBSyxHQUNMLEtBQUssR0FDSGxDLEVBQU1zQyxpQkFFTi9CLEVBREEyQixJQUFZdkIsRUFBVUosRUFBS2dDLE9BQVMsRUFBSSxFQUFJNUIsR0FDOUI2QixRQUNkckMsS0FBS2dCLFdBQVdDLElBQUl6QixFQUFTdUMsS0F6RVosV0ErRXJCLFdBQVlPLEdBQ1YsR0FEbUIsYUFDZEEsRUFBUW5DLEtBQ1gsTUFBTSxJQUFJb0MsTUFBSix5QkFDUixJQUFNdEMsRUFBUyxFQUFILENBQ1ZJLFlBQWEsYUFDVmlDLEdBRUx0QyxLQUFLQyxPQUFTLElBQUksSUFDbEJELEtBQUtnQixXQUFhLElBQUksSUFBUSxDQUFDLENBQUN4QixFQUFTLEtBQ3pDUSxLQUFLQyxPQUFPZ0IsSUFBSTFCLEVBQVVVLEdBRTFCRCxLQUFLd0MsT0ExRmMsMkNBbUduQixJQU5LLElBTVdDLEVBQUtDLEVBTmhCLEVBS0QxQyxLQUFLQyxPQUFPQyxJQUFJWCxHQUhsQmEsRUFGRyxFQUVIQSxLQUNBdUMsRUFIRyxFQUdIQSxPQUNBdEMsRUFKRyxFQUlIQSxZQUVNdUMsR0FBSyxFQUFlSCxFQUFNckMsSUFBT3dDLEtBQ3ZDRixFQUFRQyxFQUFPQyxJQUNUaEMsYUFBTixnQkFDQThCLEVBQU05QixhQUFOLG1CQUF1QzZCLEVBQUlJLElBQzNDSixFQUFJN0IsYUFBSixnQkFBa0M4QixFQUFNRyxJQUVoQyxHQUFMRCxHQUNESCxFQUFJNUIsbUJBQW1CQyxRQUFTLEVBQ2hDMkIsRUFBSTdCLGFBQUoseUJBQ0E2QixFQUFJN0IsYUFBSiwyQkFHQTZCLEVBQUloQyxVQUFVTSxJQUFJVixHQUNsQm9DLEVBQUk3QixhQUFKLHdCQUNBNkIsRUFBSTdCLGFBQUoseUJBR0Y2QixFQUFJSyxpQkFBSixRQUE4QixJQUFBckQsR0FBUSxLQUFSQSxFQUFjTyxPQUFPLEdBQ25EeUMsRUFBSUssaUJBQUosVUFBZ0MsSUFBQW5ELEdBQWtCLEtBQWxCQSxFQUF3QkssT0FBTyxHQUVqRUEsS0FBS2dCLFdBQVdDLElBQUl6QixFQUFTLEdBQzdCRSxFQUFVVSxFQUFLLEdBQU4sV0FBc0IsQ0FDN0JjLGFBQWMsRUFDZEMsV0FBWWYsRUFBSyxTQTFIQSxNQW1JVlIsYSwrUUNuSUEsR0FDYixDQUNFLEdBQU0sQ0FDSixDQUNFbUQsTUFBTyxXQUNQQyxLQUFNLFNBRVIsQ0FDRUQsTUFBTyxXQUNQQyxLQUFNLFVBRVIsQ0FDRUQsTUFBTyxXQUNQQyxLQUFNLFVBR1YsT0FBVyxDQUNULENBQ0VELE1BQU8sZUFDUEMsS0FBTSxPQUVSLENBQ0VELE1BQU8sZUFDUEMsS0FBTSxPQUVSLENBQ0VELE1BQU8sZUFDUEMsS0FBTSxRQUdWLE9BQVcsQ0FDVCxDQUNFRCxNQUFPLGVBQ1BDLEtBQU0sU0FFUixDQUNFRCxNQUFPLGVBQ1BDLEtBQU0sU0FFUixDQUNFRCxNQUFPLGVBQ1BDLEtBQU0sV0FHVixPQUFXLENBQ1QsQ0FDRUQsTUFBTyxlQUNQQyxLQUFNLE9BRVIsQ0FDRUQsTUFBTyxlQUNQQyxLQUFNLE9BRVIsQ0FDRUQsTUFBTyxlQUNQQyxLQUFNLFlBSVosQ0FDRSxHQUFNLENBQ0osQ0FDRSxNQUFTLFdBQ1QsS0FBUSxXQUVWLENBQ0UsTUFBUyxXQUNULEtBQVEsV0FFVixDQUNFLE1BQVMsV0FDVCxLQUFRLE9BR1osT0FBVSxDQUNSLENBQ0UsTUFBUyxlQUNULEtBQVEsT0FFVixDQUNFLE1BQVMsZUFDVCxLQUFRLFFBRVYsQ0FDRSxNQUFTLGVBQ1QsS0FBUSxPQUdaLE9BQVUsQ0FDUixDQUNFLE1BQVMsZUFDVCxLQUFRLGFBRVYsQ0FDRSxNQUFTLGVBQ1QsS0FBUSxVQUVWLENBQ0UsTUFBUyxlQUNULEtBQVEsUUFHWixPQUFVLENBQ1IsQ0FDRSxNQUFTLGVBQ1QsS0FBUSxVQUVWLENBQ0UsTUFBUyxlQUNULEtBQVEsU0FFVixDQUNFLE1BQVMsZUFDVCxLQUFRLGFDMUdUQyxFQUFVQyxJQUFNQyxRQUFRLENBQUMsV0FBekJGLFlBQ09HLElBQVhILEdBQ0RJLFNBQVNDLFFBQVQsY0FFRkosSUFBTUssbUJBQW1CLENBQUMsV0FFMUIsSUFBTUMsRUFBYzdCLFNBQVNwQixjQUFULGNBeUhka0QsRUF2SFksU0FBQzNELEdBQ2pCLElBQUlBLEVBQUksTUFBTSxJQUFJeUMsTUFBSiw2QkFDZCxJQUFNcEMsRUFBT0wsRUFDUDRELEVBQWlCNUQsRUFBRzZELGlCQUFILDJEQUNqQkMsRUFBcUI5RCxFQUFHNkQsaUJBQUgsK0RBQ3JCRSxFQUFxQi9ELEVBQUc2RCxpQkFBSCwrREFDckJHLEVBQXFCaEUsRUFBRzZELGlCQUFILCtEQUNyQkksRUFBYWpFLEVBQUc2RCxpQkFBSCx1QkFDYkssRUFBUWxFLEVBQUdTLGNBQWMsNEJBQ3pCMEQsRUFBWW5FLEVBQUdTLGNBQWMsZ0NBQzdCMkQsRUFBWXBFLEVBQUdTLGNBQWMsZ0NBQzdCNEQsRUFBWXJFLEVBQUdTLGNBQWMsZ0NBQzdCNkQsRUFBZXRFLEVBQUc2RCxpQkFBaUIscUNBZ0NuQ1UsRUFBbUIsU0FBQ3BCLEVBQVFwRCxHQUFVLFlBQ3BDQyxFQUFLRCxFQUFNRSxjQUNYdUUsRUFBV3hFLEVBQUd5RSxhQUFILFFBQXdCakIsUUFBeEIsWUFDWGtCLEVBQW1CLEVBQVgxRSxFQUFHMEUsTUFBWSxFQUU3QixPQUFRRixHQUNOLFNBQ0VOLEVBQU1TLElBQU4seUJBQXdCeEIsRUFBUyxFQUFqQyxnQkFBeUN5QixPQUFPRixFQUFRLEdBQXhELFFBQ0EsTUFDRixhQUNFUCxFQUFVUSxJQUFWLHlCQUE0QnhCLEVBQVMsRUFBckMsZUFBNEN5QixPQUFPRixFQUFRLEdBQTNELFFBQ0EsTUFDRixhQUNFTixFQUFVTyxJQUFWLHlCQUE0QnhCLEVBQVMsRUFBckMsZUFBNEN5QixPQUFPRixFQUFRLEdBQTNELFFBQ0EsTUFDRixhQUNFTCxFQUFVTSxJQUFWLHlCQUE0QnhCLEVBQVMsRUFBckMsZUFBNEN5QixPQUFPRixFQUFRLEdBQTNELFFBSUosR0FBR0csRUFBV1osR0FBWTNCLFFBQVUsRUFBRyw0QkFDckMsZ0JBQWlCZ0MsS0FBakIsMEJBQStCLFNBQ3ZCM0QsVUFBVUUsT0FBaEIsZ0JBRm1DLHFGQU9uQ2dFLEVBQWEsU0FBQ0MsR0FBVyxRQUM3QkEsRUFBU0EsR0FBVWIsRUFDbkIsSUFBTWMsRUFBTSxDQUFDekMsT0FBUSxHQU9yQixPQU5BLGdCQUFXd0MsSUFBWCxRQUNVLFNBQUFFLEdBQUksT0FBSUEsRUFBS0MsWUFEdkIsUUFFVyxTQUFBRCxHQUNQRCxFQUFJQyxFQUFLOUIsS0FBS00sUUFBVixhQUErQyxFQUFid0IsRUFBS04sTUFDM0NLLEVBQUl6QyxRQUFVLEtBRVh5QyxHQUdULE1BQU8sQ0FDTHJDLEtBREssU0FDQVMsR0FBUSxPQXRFYSxTQUFDQSxHQUFXLFlBQ3RDLFFBQWNHLElBQVhILEVBQXNCLE1BQU0sSUFBSVYsTUFBSixxQ0FFL0IsSUFBTXlDLEVBQWEsWUFBSCxPQUFlL0IsRUFBUyxFQUF4QixlQUNWZ0MsRUFBYSxZQUFILE9BQWVoQyxFQUFTLEVBQXhCLGVBQ1ZpQyxFQUFhLFlBQUgsT0FBZWpDLEVBQVMsRUFBeEIsZUFDVmtDLEVBQWEsWUFBSCxPQUFlbEMsRUFBUyxFQUF4QixlQUVoQjlDLEVBQUtJLGNBQWMsNkJBQTZCa0UsSUFBTU8sRUFDdEQ3RSxFQUFLSSxjQUFjLGlDQUFpQ2tFLElBQU1RLEVBQzFEOUUsRUFBS0ksY0FBYyxpQ0FBaUNrRSxJQUFNUyxFQUMxRC9FLEVBQUtJLGNBQWMsaUNBQWlDa0UsSUFBTVUsRUFFMUQsVUFBV3pCLElBQVgsUUFBbUMsU0FBQzBCLEVBQU1DLEdBQ3hDRCxFQUFLM0UsVUFBVU0sSUFBZiw0QkFBd0N1RSxFQUFVckMsR0FBVixHQUF3Qm9DLEdBQXhCLFdBRTFDLFVBQVd6QixJQUFYLFFBQXVDLFNBQUN3QixFQUFNQyxHQUM1Q0QsRUFBSzNFLFVBQVVNLElBQWYsNEJBQXdDdUUsRUFBVXJDLEdBQVYsT0FBNEJvQyxHQUE1QixXQUUxQyxVQUFXeEIsSUFBWCxRQUF1QyxTQUFDdUIsRUFBTUMsR0FDNUNELEVBQUszRSxVQUFVTSxJQUFmLDRCQUF3Q3VFLEVBQVVyQyxHQUFWLE9BQTRCb0MsR0FBNUIsV0FFMUMsVUFBV3ZCLElBQVgsUUFBdUMsU0FBQ3NCLEVBQU1DLEdBQzVDRCxFQUFLM0UsVUFBVU0sSUFBZiw0QkFBd0N1RSxFQUFVckMsR0FBVixPQUE0Qm9DLEdBQTVCLFdBdkJKLDJCQXlCdEMsZ0JBQXVCakIsS0FBdkIsMEJBQXFDLFNBQ3ZCM0QsVUFBVU0sSUFBdEIsZ0JBMUJvQyxtRkF1RXBDd0UsQ0FBb0J0QyxHQUVwQixJQURBLElBQ2dCdUMsRUFEVkMsRUFBUyxVQUFjSCxFQUFVckMsS0FBeEIsUUFGSixXQUdITCxFQUFRNEMsR0FFZCxLQUFXLFdBQ1RBLEVBQVNULFNBQVUsSUFDbEIsSUFDSFMsRUFBUzNFLG1CQUFtQkQsYUFBNUIsYUFBdUQ2RSxFQUFPN0MsR0FBUCxNQUN2RDRDLEVBQVMxQyxpQkFBVCxTQUFvQyxJQUFBdUIsR0FBZ0IsS0FBaEJBLEVBQXNCLEtBQU1wQixJQUFTLElBTm5FTCxHQUFLLEVBQWE0QyxFQUFXekIsSUFBYW5CLElBQUssRUFBL0NBLEVBQVE0QyxJQVNsQkUsZUFiSyxTQWFVN0YsR0FDYixJQUFNOEYsRUFBWTlGLEVBQU11QixPQUFPRCxXQUFXMEIsR0FBR1MsUUFBUSxrQkFBbkMsSUFFYnNDLFFBQVFDLFVBQVVDLFVBQ3JCRixRQUFRQyxVQUFVQyxRQUFVRixRQUFRQyxVQUFVRSxtQkFDOUNILFFBQVFDLFVBQVVHLHVCQUxBLDJCQVFwQixnQkFBaUI1QixLQUFqQiwwQkFBK0IsS0FBdkI2QixFQUF1QixRQUMxQkEsRUFBTUgsUUFBTixpQ0FBd0NILElBQ3pDTSxFQUFNeEYsVUFBVUUsT0FBaEIsZUFDT2dFLEVBQVdaLEdBQVkzQixPQUFTLEdBQ3ZDNkQsRUFBTXhGLFVBQVVNLElBQWhCLGdCQVpnQixvRkFnQnRCbUYsU0E3QkssU0E2QklyRyxHQUNQLE9BQXdDLEdBQWpDOEUsRUFBV1osR0FBWTNCLFFBRWhDdUMsY0FJY3dCLENBQVV4RSxTQUFTcEIsY0FBVCx1QkFDNUJrRCxFQUFVakIsS0FBS1MsR0FFZixJQUFNbUQsRUFBZ0J6RSxTQUFTcEIsY0FBVCx1QkFDdEI2RixFQUFjdEQsaUJBQWQsV0FBMkNXLEVBQVVpQyxnQkFBZ0IsR0FFbkQsSUFBSTlGLElBQVUsQ0FDOUJPLEtBQU1pRyxFQUNOaEcsS0FBTXVCLFNBQVNnQyxpQkFBVCw0QkFDTmhCLE9BQVFoQixTQUFTZ0MsaUJBQVQsOENBQ1J0RCxZQUFhLFdBR2ZtRCxFQUFZVixpQkFBWixTQUFzQyxTQUFBakQsR0FDcEMsSUFBSTRELEVBQVV5QyxXQUdaLE9BRkFyRyxFQUFNc0Msc0JBQ05rRSxNQUFNLG9CQUhxQyxNQU1SNUMsRUFBVWtCLGFBQXhDMkIsRUFOc0MsRUFNdENBLEdBQUlDLEVBTmtDLEVBTWxDQSxPQUFRQyxFQU4wQixFQU0xQkEsT0FBUUMsRUFOa0IsRUFNbEJBLE9BQzNCdkQsSUFBTXdELGlCQUFpQixDQUFDSixLQUFJQyxTQUFRQyxTQUFRQyxjQUMzQyxJLGtuQkMzSkgsSUFBSUUsRUFBT0MsS0FBS0MsTUFBTUMsZUFBZUMsUUFBZixtQkFBNEMsR0FFNURDLEVBQWMsU0FBQUwsR0FDbEJHLGVBQWVHLFFBQWYsZ0JBQXdDLElBQWVOLEtBR25EekQsRUFBUSxDQUNaZ0UsTUFEWSxXQUVWSixlQUFlSyxXQUFmLGtCQUVGaEUsUUFKWSxXQUtWLE9BQU93RCxHQUVUUyxrQkFQWSxTQU9NbkUsR0FHaEIsT0FGQTBELEVBQU8sRUFBSCxHQUFPQSxFQUFQLENBQWExRCxXQUNqQitELEVBQVlMLEdBQ0xBLEdBRVRELGlCQVpZLFNBWUtqQixHQUdmLE9BRkFrQixFQUFPLEVBQUgsR0FBT0EsRUFBUCxDQUFhbEIsV0FDakJ1QixFQUFZTCxHQUNMQSxHQUVUVSxZQWpCWSxTQWlCQUMsR0FHVixPQUZBWCxFQUFPLEVBQUgsR0FBT0EsRUFBUCxDQUFhVyxZQUNqQk4sRUFBWUwsR0FDTEEsR0FFVHBELG1CQXRCWSxTQXNCT2dFLEdBQU8sMkJBQ3hCLGdCQUFnQkEsS0FBaEIsMEJBQXVCLEtBQWZ6QyxFQUFlLGVBQ2Q2QixFQUFLN0IsSUFGVSxrRkFLeEIsT0FEQWtDLEVBQVlMLEdBQ0xBLElBSUl6RCxRIiwiZmlsZSI6InNjcmlwdC9zdGVwMi4xMTFhMTcxYi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShgLi9zcmNgKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vQWNjb3JkaW9uJyk7IiwiY29uc3QgQWNjb3JkaW9uID0gKCgpID0+IHtcbiAgbGV0IHNldHRpbmdzID0ge307XG4gIGxldCBjdXJyZW50ID0ge2N1cnJlbnQ6IGBjdXJyZW50YH07XG5cbiAgY29uc3QgYWN0aXZhdGUgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IGVsID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICBjb25zdCB7XG4gICAgICByb290LFxuICAgICAgdGFicyxcbiAgICAgIGFjdGl2ZUNsYXNzLFxuICAgIH0gPSB0aGlzLmNvbmZpZy5nZXQoc2V0dGluZ3MpO1xuICAgIGNvbnN0IGN1cnJBY3RpdmF0ZWRFbCA9IHJvb3QucXVlcnlTZWxlY3RvcihgLiR7YWN0aXZlQ2xhc3N9YCk7XG4gICAgY29uc3QgY3VycklkeCA9IEFycmF5LmZyb20odGFicykuaW5kZXhPZihlbCk7XG5cbiAgICBpZihlbC5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSByZXR1cm47XG4gICAgaWYoY3VyckFjdGl2YXRlZEVsKSB7XG4gICAgICBjdXJyQWN0aXZhdGVkRWwuY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVDbGFzcyk7XG4gICAgICBjdXJyQWN0aXZhdGVkRWwuc2V0QXR0cmlidXRlKGBhcmlhLWV4cGFuZGVkYCwgYGZhbHNlYCk7XG4gICAgICBjdXJyQWN0aXZhdGVkRWwuc2V0QXR0cmlidXRlKGBhcmlhLWRpc2FibGVkYCwgYGZhbHNlYCk7XG4gICAgICBjdXJyQWN0aXZhdGVkRWwubmV4dEVsZW1lbnRTaWJsaW5nLmhpZGRlbiA9IHRydWU7XG4gICAgfVxuICAgIGVsLmNsYXNzTGlzdC5hZGQoYWN0aXZlQ2xhc3MpO1xuICAgIGVsLnNldEF0dHJpYnV0ZShgYXJpYS1leHBhbmRlZGAsIGB0cnVlYCk7XG4gICAgZWwuc2V0QXR0cmlidXRlKGBhcmlhLWRpc2FibGVkYCwgYHRydWVgKTtcbiAgICBlbC5uZXh0RWxlbWVudFNpYmxpbmcuaGlkZGVuID0gZmFsc2U7XG5cbiAgICB0aGlzLmN1cnJlbnRJZHguc2V0KGN1cnJlbnQsIGN1cnJJZHgpO1xuICAgIGVtaXRFdmVudChlbCwgYHNlbGVjdGVkYCwge1xuICAgICAgYWN0aXZhdGVkSWR4OiBjdXJySWR4LFxuICAgICAgYWN0aXZhdGVFbDogZWwsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgZW1pdEV2ZW50ID0gKGVsLCBldmVudCwgZGV0YWlsKSA9PiB7XG4gICAgbGV0IGN1c3RvbUV2ZW50O1xuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgIGRldGFpbDoge1xuICAgICAgICAuLi5kZXRhaWxcbiAgICAgIH0sXG4gICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICB9O1xuICAgIGlmICh0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudCwgcGFyYW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICAgIGN1c3RvbUV2ZW50LmluaXRDdXN0b21FdmVudChldmVudCwgdHJ1ZSwgdHJ1ZSwgcGFyYW1zLmRldGFpbCk7XG4gICAgfVxuXG4gICAgZWwuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gIH1cblxuICBjb25zdCBiaW5kSGVhZGVyS2V5RXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IGVsID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICBjb25zdCBrZXljb2RlID0gZXZlbnQua2V5Q29kZSB8fCBldmVudC53aGljaDtcbiAgICBjb25zdCB7XG4gICAgICB0YWJzLFxuICAgIH0gPSB0aGlzLmNvbmZpZy5nZXQoc2V0dGluZ3MpO1xuICAgIGxldCBjdXJySWR4ID0gdGhpcy5jdXJyZW50SWR4LmdldChjdXJyZW50KTtcbiAgICBsZXQgbmV4dElkeDtcbiAgICBzd2l0Y2goa2V5Y29kZSkge1xuICAgICAgY2FzZSAzNzpcbiAgICAgIGNhc2UgMzg6XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIG5leHRJZHggPSAtLWN1cnJJZHggPCAwID8gdGFicy5sZW5ndGggLSAxIDogY3VycklkeDtcbiAgICAgICAgdGFic1tuZXh0SWR4XS5mb2N1cygpO1xuICAgICAgICB0aGlzLmN1cnJlbnRJZHguc2V0KGN1cnJlbnQsIG5leHRJZHgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzk6XG4gICAgICBjYXNlIDQwOlxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBuZXh0SWR4ID0gKytjdXJySWR4ID4gdGFicy5sZW5ndGggLSAxID8gMCA6IGN1cnJJZHg7XG4gICAgICAgIHRhYnNbbmV4dElkeF0uZm9jdXMoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50SWR4LnNldChjdXJyZW50LCBuZXh0SWR4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9O1xuXG4gIGNsYXNzIEFjY29yZGlvbiB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgaWYoISBvcHRpb25zLnJvb3QpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJ3Jvb3QnIGlzIG5vdCBkZWZpbmVkYCk7XG4gICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgIGFjdGl2ZUNsYXNzOiBgYWN0aXZhdGVkYCxcbiAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIH07XG4gICAgICB0aGlzLmNvbmZpZyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICB0aGlzLmN1cnJlbnRJZHggPSBuZXcgV2Vha01hcChbW2N1cnJlbnQsIDBdXSk7XG4gICAgICB0aGlzLmNvbmZpZy5zZXQoc2V0dGluZ3MsIGNvbmZpZyk7XG5cbiAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cblxuICAgIGluaXQoKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHRhYnMsXG4gICAgICAgIHBhbmVscyxcbiAgICAgICAgYWN0aXZlQ2xhc3NcbiAgICAgIH0gPSB0aGlzLmNvbmZpZy5nZXQoc2V0dGluZ3MpO1xuICAgICAgZm9yKGxldCBpID0gLTEsIHRhYiwgcGFuZWw7IHRhYiA9IHRhYnNbKytpXTspIHtcbiAgICAgICAgcGFuZWwgPSBwYW5lbHNbaV07XG4gICAgICAgIHBhbmVsLnNldEF0dHJpYnV0ZShgcm9sZWAsIGBncm91cGApO1xuICAgICAgICBwYW5lbC5zZXRBdHRyaWJ1dGUoYGFyaWEtZGVzY3JpYmVkYnlgLCB0YWIuaWQpO1xuICAgICAgICB0YWIuc2V0QXR0cmlidXRlKGBhcmlhLWNvbnRyb2xzYCwgcGFuZWwuaWQpO1xuXG4gICAgICAgIGlmKGkgIT0gMCkge1xuICAgICAgICAgIHRhYi5uZXh0RWxlbWVudFNpYmxpbmcuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICB0YWIuc2V0QXR0cmlidXRlKGBhcmlhLWV4cGFuZGVkYCwgYGZhbHNlYCk7XG4gICAgICAgICAgdGFiLnNldEF0dHJpYnV0ZShgYXJpYS1kaXNhYmxlZGAsIGBmYWxzZWApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKGFjdGl2ZUNsYXNzKTtcbiAgICAgICAgICB0YWIuc2V0QXR0cmlidXRlKGBhcmlhLWV4cGFuZGVkYCwgYHRydWVgKTtcbiAgICAgICAgICB0YWIuc2V0QXR0cmlidXRlKGBhcmlhLWRpc2FibGVkYCwgYHRydWVgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhYi5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIGFjdGl2YXRlLmJpbmQodGhpcyksIGZhbHNlKTtcbiAgICAgICAgdGFiLmFkZEV2ZW50TGlzdGVuZXIoYGtleWRvd25gLCBiaW5kSGVhZGVyS2V5RXZlbnQuYmluZCh0aGlzKSwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgdGhpcy5jdXJyZW50SWR4LnNldChjdXJyZW50LCAwKTtcbiAgICAgIGVtaXRFdmVudCh0YWJzWzBdLCBgc2VsZWN0ZWRgLCB7XG4gICAgICAgIGFjdGl2YXRlZElkeDogMCxcbiAgICAgICAgYWN0aXZhdGVFbDogdGFic1swXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBBY2NvcmRpb247XG59KSgpO1xuXG5cbmV4cG9ydCBkZWZhdWx0IEFjY29yZGlvbjsiLCJleHBvcnQgZGVmYXVsdCBbXG4gIHtcbiAgICAnYmcnOiBbXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWJnLTEnLFxuICAgICAgICBuYW1lOiAn67Cd7J2AIOyYpeyDiSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWJnLTInLFxuICAgICAgICBuYW1lOiAn7YyM7Jqw642UIOu4lOujqCdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWJnLTMnLFxuICAgICAgICBuYW1lOiAn67Cd7J2AIOu2hO2ZjSdcbiAgICAgIH1cbiAgICBdLFxuICAgICdncm91cGEnIDogW1xuICAgICAge1xuICAgICAgICBjbGFzczogJ2N0MS1ncm91cGEtMScsXG4gICAgICAgIG5hbWU6ICfruYTrsoTsg4knXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjbGFzczogJ2N0MS1ncm91cGEtMicsXG4gICAgICAgIG5hbWU6ICfrsoTrsojsg4knXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjbGFzczogJ2N0MS1ncm91cGEtMycsXG4gICAgICAgIG5hbWU6ICftmLjrkZDsg4knXG4gICAgICB9XG4gICAgXSxcbiAgICAnZ3JvdXBiJyA6IFtcbiAgICAgIHtcbiAgICAgICAgY2xhc3M6ICdjdDEtZ3JvdXBiLTEnLFxuICAgICAgICBuYW1lOiAn7Jik65yoIO2Vke2BrCdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWdyb3VwYi0yJyxcbiAgICAgICAgbmFtZTogJ+uUpSDruJTrn6zsiawnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjbGFzczogJ2N0MS1ncm91cGItMycsXG4gICAgICAgIG5hbWU6ICfrk7HrgpjrrLQg6r2D7IOJJ1xuICAgICAgfVxuICAgIF0sXG4gICAgJ2dyb3VwYycgOiBbXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWdyb3VwYy0xJyxcbiAgICAgICAgbmFtZTogJ+udvOuypOuNlCdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWdyb3VwYy0yJyxcbiAgICAgICAgbmFtZTogJ+uyhO2EsOyDiSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzOiAnY3QxLWdyb3VwYy0zJyxcbiAgICAgICAgbmFtZTogJ+yKpOychO2KuCDroZzspognXG4gICAgICB9XG4gICAgXVxuICB9LFxuICB7XG4gICAgJ2JnJzogW1xuICAgICAge1xuICAgICAgICAnY2xhc3MnOiAnY3QyLWJnLTEnLFxuICAgICAgICAnbmFtZSc6ICfrsJ3snYAg7JeQ67KE6re466awJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ2NsYXNzJzogJ2N0Mi1iZy0yJyxcbiAgICAgICAgJ25hbWUnOiAn67iU66as7J6Q65OcIOu4lOujqCdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICdjbGFzcyc6ICdjdDItYmctMycsXG4gICAgICAgICduYW1lJzogJ+uyhO2EsCdcbiAgICAgIH1cbiAgICBdLFxuICAgICdncm91cGEnOiBbXG4gICAgICB7XG4gICAgICAgICdjbGFzcyc6ICdjdDItZ3JvdXBhLTEnLFxuICAgICAgICAnbmFtZSc6ICftlZjripjsg4knXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAnY2xhc3MnOiAnY3QyLWdyb3VwYS0yJyxcbiAgICAgICAgJ25hbWUnOiAn67iU66Oo67Kg66asJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ2NsYXNzJzogJ2N0Mi1ncm91cGEtMycsXG4gICAgICAgICduYW1lJzogJ+ugiOuqrCdcbiAgICAgIH1cbiAgICBdLFxuICAgICdncm91cGInOiBbXG4gICAgICB7XG4gICAgICAgICdjbGFzcyc6ICdjdDItZ3JvdXBiLTEnLFxuICAgICAgICAnbmFtZSc6ICfsl7DtlZwg642p7L+o7J6l66+4IOyDiSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICdjbGFzcyc6ICdjdDItZ3JvdXBiLTInLFxuICAgICAgICAnbmFtZSc6ICfrsoTthLAg7YGs66a87IOJJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ2NsYXNzJzogJ2N0Mi1ncm91cGItMycsXG4gICAgICAgICduYW1lJzogJ+2VmOuKmOyDiSdcbiAgICAgIH1cbiAgICBdLFxuICAgICdncm91cGMnOiBbXG4gICAgICB7XG4gICAgICAgICdjbGFzcyc6ICdjdDItZ3JvdXBjLTEnLFxuICAgICAgICAnbmFtZSc6ICfruYTrhIjsiqQg7ZWR7YGsJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ2NsYXNzJzogJ2N0Mi1ncm91cGMtMicsXG4gICAgICAgICduYW1lJzogJ+uzteyIreyVhCDsg4knXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAnY2xhc3MnOiAnY3QyLWdyb3VwYy0zJyxcbiAgICAgICAgJ25hbWUnOiAn7KeZ7J2AIOyggeqwiOyDiSdcbiAgICAgIH1cbiAgICBdXG4gIH1cbl07IiwiaW1wb3J0IFwiLi4vc2Nzcy9zdGVwMi5zY3NzXCI7XG5pbXBvcnQgXCJNb2R1bGVzL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlL3Njc3MvZm9udGF3ZXNvbWUuc2Nzc1wiO1xuaW1wb3J0IFwiTW9kdWxlcy9AZm9ydGF3ZXNvbWUvZm9udGF3ZXNvbWUtZnJlZS9zY3NzL3NvbGlkLnNjc3NcIjtcbmltcG9ydCBBY2NvcmRpb24gZnJvbSAnLi9BY2NvcmRpb24nO1xuaW1wb3J0IHN0b3JlIGZyb20gJy4vU3RvcmUnO1xuaW1wb3J0IGNvbG9yTGlzdCBmcm9tICcuL1N0b3JlL2NvbG9yTGlzdCc7XG5cbmNvbnN0IHtkZXNpZ259ID0gc3RvcmUuZ2V0RGF0YShbYGRlc2lnbmBdKTtcbmlmKGRlc2lnbiA9PT0gdW5kZWZpbmVkKSB7XG4gIGxvY2F0aW9uLnJlcGxhY2UoYGluZGV4Lmh0bWxgKTtcbn1cbnN0b3JlLnJlc2V0U2VsZWN0ZWRJdGVtcyhbYGNvbG9yc2BdKTtcblxuY29uc3QgbmV4dFN0ZXBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAubmV4dC1zdGVwYCk7XG5cbmNvbnN0IERyYXdDb2xvciA9IChlbCkgPT4ge1xuICBpZighZWwpIHRocm93IG5ldyBFcnJvcihgRHJhd0NhbnZhcyBpcyBub3QgZGVmaW5lZGApO1xuICBjb25zdCByb290ID0gZWw7XG4gIGNvbnN0IGJnQ29sb3JCdXR0b25zID0gZWwucXVlcnlTZWxlY3RvckFsbChgW25hbWU9XCJkcmF3LWJnXCJdLmNvbG9yaW5nX19jaGVja2JveCArIC5jb2xvcmluZ19fYnV0dG9uYCk7XG4gIGNvbnN0IGdyb3VwQUNvbG9yQnV0dG9ucyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoYFtuYW1lPVwiZHJhdy1ncm91cGFcIl0uY29sb3JpbmdfX2NoZWNrYm94ICsgLmNvbG9yaW5nX19idXR0b25gKTtcbiAgY29uc3QgZ3JvdXBCQ29sb3JCdXR0b25zID0gZWwucXVlcnlTZWxlY3RvckFsbChgW25hbWU9XCJkcmF3LWdyb3VwYlwiXS5jb2xvcmluZ19fY2hlY2tib3ggKyAuY29sb3JpbmdfX2J1dHRvbmApO1xuICBjb25zdCBncm91cENDb2xvckJ1dHRvbnMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKGBbbmFtZT1cImRyYXctZ3JvdXBjXCJdLmNvbG9yaW5nX19jaGVja2JveCArIC5jb2xvcmluZ19fYnV0dG9uYCk7XG4gIGNvbnN0IGNoZWNrYm94ZXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKGBpbnB1dFt0eXBlPVwicmFkaW9cIl1gKTtcbiAgY29uc3QgYmdJbWcgPSBlbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzX19sYXllci0tY29sb3ItYmcnKTtcbiAgY29uc3QgZ3JvdXBBSW1nID0gZWwucXVlcnlTZWxlY3RvcignLmNhbnZhc19fbGF5ZXItLWNvbG9yLWdyb3VwYScpO1xuICBjb25zdCBncm91cEJJbWcgPSBlbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzX19sYXllci0tY29sb3ItZ3JvdXBiJyk7XG4gIGNvbnN0IGdyb3VwQ0ltZyA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXNfX2xheWVyLS1jb2xvci1ncm91cGMnKTtcbiAgY29uc3Qgc2tldGNoTGF5ZXJzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnW2NsYXNzKj1cImNhbnZhc19fbGF5ZXItLXNrZXRjaC1cIl0nKTtcblxuICBjb25zdCBsb2FkRGVmYXVsdFNrZXRjaGVzID0gKGRlc2lnbikgPT4ge1xuICAgIGlmKGRlc2lnbiA9PT0gdW5kZWZpbmVkKSB0aHJvdyBuZXcgRXJyb3IoYFtEcmF3Q29sb3JdIGRlc2lnbiBpcyBub3QgZGVmaW5lZGApO1xuXG4gICAgY29uc3Qgc2tldGNoUGF0aCA9IGBpbWFnZXMvY3Qke2Rlc2lnbiArIDF9X2JnXzBfMC5zdmdgO1xuICAgIGNvbnN0IGdyb3VwQVBhdGggPSBgaW1hZ2VzL2N0JHtkZXNpZ24gKyAxfV9iZ18wXzEuc3ZnYDtcbiAgICBjb25zdCBncm91cEJQYXRoID0gYGltYWdlcy9jdCR7ZGVzaWduICsgMX1fYmdfMF8yLnN2Z2A7XG4gICAgY29uc3QgZ3JvdXBDUGF0aCA9IGBpbWFnZXMvY3Qke2Rlc2lnbiArIDF9X2JnXzBfMy5zdmdgO1xuXG4gICAgcm9vdC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzX19sYXllci0tc2tldGNoLWJnJykuc3JjID0gc2tldGNoUGF0aDtcbiAgICByb290LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXNfX2xheWVyLS1za2V0Y2gtZ3JvdXBhJykuc3JjID0gZ3JvdXBBUGF0aDtcbiAgICByb290LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXNfX2xheWVyLS1za2V0Y2gtZ3JvdXBiJykuc3JjID0gZ3JvdXBCUGF0aDtcbiAgICByb290LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXNfX2xheWVyLS1za2V0Y2gtZ3JvdXBjJykuc3JjID0gZ3JvdXBDUGF0aDtcblxuICAgIEFycmF5LmZyb20oYmdDb2xvckJ1dHRvbnMpLmZvckVhY2goKGVsZW0sIGlkeCkgPT4ge1xuICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKGBjb2xvcmluZ19fYnV0dG9uLS0ke2NvbG9yTGlzdFtkZXNpZ25dW1wiYmdcIl1baWR4XVtcImNsYXNzXCJdfWApXG4gICAgfSk7XG4gICAgQXJyYXkuZnJvbShncm91cEFDb2xvckJ1dHRvbnMpLmZvckVhY2goKGVsZW0sIGlkeCkgPT4ge1xuICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKGBjb2xvcmluZ19fYnV0dG9uLS0ke2NvbG9yTGlzdFtkZXNpZ25dW1wiZ3JvdXBhXCJdW2lkeF1bXCJjbGFzc1wiXX1gKVxuICAgIH0pO1xuICAgIEFycmF5LmZyb20oZ3JvdXBCQ29sb3JCdXR0b25zKS5mb3JFYWNoKChlbGVtLCBpZHgpID0+IHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZChgY29sb3JpbmdfX2J1dHRvbi0tJHtjb2xvckxpc3RbZGVzaWduXVtcImdyb3VwYlwiXVtpZHhdW1wiY2xhc3NcIl19YClcbiAgICB9KTtcbiAgICBBcnJheS5mcm9tKGdyb3VwQ0NvbG9yQnV0dG9ucykuZm9yRWFjaCgoZWxlbSwgaWR4KSA9PiB7XG4gICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoYGNvbG9yaW5nX19idXR0b24tLSR7Y29sb3JMaXN0W2Rlc2lnbl1bXCJncm91cGNcIl1baWR4XVtcImNsYXNzXCJdfWApXG4gICAgfSk7XG4gICAgZm9yKGxldCBza2V0Y2hMYXllciBvZiBza2V0Y2hMYXllcnMpIHtcbiAgICAgIHNrZXRjaExheWVyLmNsYXNzTGlzdC5hZGQoYGRlaGlnaGxpZ2h0YCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgaGFuZGxlQ29sb3JDaGVjayA9IChkZXNpZ24sIGV2ZW50KSA9PiB7XG4gICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgIGNvbnN0IGNhdGVnb3J5ID0gZWwuZ2V0QXR0cmlidXRlKGBuYW1lYCkucmVwbGFjZShgZHJhdy1gLCBgYCk7XG4gICAgY29uc3QgdmFsdWUgPSBlbC52YWx1ZSAqIDEgKyAxO1xuXG4gICAgc3dpdGNoIChjYXRlZ29yeSkge1xuICAgICAgY2FzZSBgYmdgOlxuICAgICAgICBiZ0ltZy5zcmMgPSBgaW1hZ2VzL2N0JHtkZXNpZ24gKyAxfV9iZ18ke051bWJlcih2YWx1ZSAtIDEpfS5zdmdgO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYGdyb3VwYWA6XG4gICAgICAgIGdyb3VwQUltZy5zcmMgPSBgaW1hZ2VzL2N0JHtkZXNpZ24gKyAxfV8xXyR7TnVtYmVyKHZhbHVlIC0gMSl9LnN2Z2A7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBgZ3JvdXBiYDpcbiAgICAgICAgZ3JvdXBCSW1nLnNyYyA9IGBpbWFnZXMvY3Qke2Rlc2lnbiArIDF9XzJfJHtOdW1iZXIodmFsdWUgLSAxKX0uc3ZnYDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGBncm91cGNgOlxuICAgICAgICBncm91cENJbWcuc3JjID0gYGltYWdlcy9jdCR7ZGVzaWduICsgMX1fM18ke051bWJlcih2YWx1ZSAtIDEpfS5zdmdgO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZihnZXRDaGVja2VkKGNoZWNrYm94ZXMpLmxlbmd0aCA+PSA0KSB7XG4gICAgICBmb3IobGV0IGxheWVyIG9mIHNrZXRjaExheWVycykge1xuICAgICAgICBsYXllci5jbGFzc0xpc3QucmVtb3ZlKGBkZWhpZ2hsaWdodGApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZXRDaGVja2VkID0gKHRhcmdldCkgPT4ge1xuICAgIHRhcmdldCA9IHRhcmdldCB8fCBjaGVja2JveGVzO1xuICAgIGNvbnN0IG9iaiA9IHtsZW5ndGg6IDB9O1xuICAgIEFycmF5LmZyb20odGFyZ2V0KVxuICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0uY2hlY2tlZClcbiAgICAgIC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBvYmpbaXRlbS5uYW1lLnJlcGxhY2UoYGRyYXctYCwgYGApXSA9IGl0ZW0udmFsdWUgKiAxO1xuICAgICAgICBvYmoubGVuZ3RoICs9IDE7XG4gICAgICB9KTtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0KGRlc2lnbikge1xuICAgICAgbG9hZERlZmF1bHRTa2V0Y2hlcyhkZXNpZ24pO1xuICAgICAgY29uc3QgY29sb3JzID0gT2JqZWN0LnZhbHVlcyhjb2xvckxpc3RbZGVzaWduXSkuZmxhdCgpO1xuICAgICAgZm9yKGxldCBpID0gLTEsIGNoZWNrYm94OyBjaGVja2JveCA9IGNoZWNrYm94ZXNbKytpXTspIHtcbiAgICAgICAgLy8gZm9yIElFIHJlZmVzaCBpc3N1ZVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gZmFsc2VcbiAgICAgICAgfSwgMTApO1xuICAgICAgICBjaGVja2JveC5uZXh0RWxlbWVudFNpYmxpbmcuc2V0QXR0cmlidXRlKGBhcmlhLWxhYmVsYCwgY29sb3JzW2ldW2BuYW1lYF0pO1xuICAgICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKGBjaGFuZ2VgLCBoYW5kbGVDb2xvckNoZWNrLmJpbmQobnVsbCwgZGVzaWduKSwgZmFsc2UpO1xuICAgICAgfVxuICAgIH0sXG4gICAgaGlnaGxpZ2h0TGF5ZXIoZXZlbnQpIHtcbiAgICAgIGNvbnN0IGFjdGl2YXRlZCA9IGV2ZW50LmRldGFpbC5hY3RpdmF0ZUVsLmlkLnJlcGxhY2UoL2RyYXdcXC18LWxlZ2VuZC9nLCBgYCk7XG4gICAgICAvLyBmb3IgSUVcbiAgICAgIGlmICghRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcykge1xuICAgICAgICBFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgICAgRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xuICAgICAgfVxuXG4gICAgICBmb3IobGV0IGxheWVyIG9mIHNrZXRjaExheWVycykge1xuICAgICAgICBpZihsYXllci5tYXRjaGVzKGAuY2FudmFzX19sYXllci0tc2tldGNoLSR7YWN0aXZhdGVkfWApICkge1xuICAgICAgICAgIGxheWVyLmNsYXNzTGlzdC5yZW1vdmUoYGRlaGlnaGxpZ2h0YCk7XG4gICAgICAgIH1lbHNlIGlmKGdldENoZWNrZWQoY2hlY2tib3hlcykubGVuZ3RoIDwgNCl7XG4gICAgICAgICAgbGF5ZXIuY2xhc3NMaXN0LmFkZChgZGVoaWdobGlnaHRgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgdmFsaWRhdGUoZXZlbnQpIHtcbiAgICAgIHJldHVybiBnZXRDaGVja2VkKGNoZWNrYm94ZXMpLmxlbmd0aCA9PSA0O1xuICAgIH0sXG4gICAgZ2V0Q2hlY2tlZCxcbiAgfVxufVxuXG5jb25zdCBkcmF3Q29sb3IgPSBEcmF3Q29sb3IoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmNhbnZhc19fY29udGFpbmVyYCkpO1xuZHJhd0NvbG9yLmluaXQoZGVzaWduKTtcblxuY29uc3QgYWNjb3JkaW9uUm9vdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jb2xvcmluZy1hY2NvcmRpb25gKTtcbmFjY29yZGlvblJvb3QuYWRkRXZlbnRMaXN0ZW5lcihgc2VsZWN0ZWRgLCBkcmF3Q29sb3IuaGlnaGxpZ2h0TGF5ZXIsIGZhbHNlKTtcblxuY29uc3QgYWNjb3JkaW9uID0gbmV3IEFjY29yZGlvbih7XG4gIHJvb3Q6IGFjY29yZGlvblJvb3QsXG4gIHRhYnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5jb2xvcmluZy1hY2NvcmRpb25fX3RhYmApLFxuICBwYW5lbHM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5jb2xvcmluZy1hY2NvcmRpb25fX3BhbmVsIC5jb2xvcmluZ19fbGlzdGApLFxuICBhY3RpdmVDbGFzczogYGFjdGl2ZWAsXG59KTtcblxubmV4dFN0ZXBCdG4uYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBldmVudCA9PiB7XG4gIGlmKCFkcmF3Q29sb3IudmFsaWRhdGUoKSkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgYWxlcnQoYOyDieydhCDrqqjrkZAg7Lmg7ZWY7KeAIOyViuycvOyFqOyWtOyalH5gKTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qge2JnLCBncm91cGEsIGdyb3VwYiwgZ3JvdXBjfSA9IGRyYXdDb2xvci5nZXRDaGVja2VkKCk7XG4gIHN0b3JlLnNldFNlbGVjdGVkQ29sb3Ioe2JnLCBncm91cGEsIGdyb3VwYiwgZ3JvdXBjfSk7XG59LCBmYWxzZSk7IiwibGV0IGRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oYGN1c3RvbWVkLW9yZW9gKSkgfHwge307XG5cbmNvbnN0IHVwZGF0ZVN0b3JlID0gZGF0YSA9PiB7XG4gIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oYGN1c3RvbWVkLW9yZW9gLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG59XG5cbmNvbnN0IHN0b3JlID0ge1xuICBjbGVhcigpIHtcbiAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKGBjdXN0b21lZC1vcmVvYCk7XG4gIH0sXG4gIGdldERhdGEoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0sXG4gIHNldFNlbGVjdGVkRGVzaWduKGRlc2lnbikge1xuICAgIGRhdGEgPSB7Li4uZGF0YSwgZGVzaWdufTtcbiAgICB1cGRhdGVTdG9yZShkYXRhKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfSxcbiAgc2V0U2VsZWN0ZWRDb2xvcihjb2xvcnMpIHtcbiAgICBkYXRhID0gey4uLmRhdGEsIGNvbG9yc307XG4gICAgdXBkYXRlU3RvcmUoZGF0YSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0sXG4gIHNldE1lc3NzYWdlKG1lc3NhZ2UpIHtcbiAgICBkYXRhID0gey4uLmRhdGEsIG1lc3NhZ2V9O1xuICAgIHVwZGF0ZVN0b3JlKGRhdGEpO1xuICAgIHJldHVybiBkYXRhO1xuICB9LFxuICByZXNldFNlbGVjdGVkSXRlbXMoaXRlbXMpIHtcbiAgICBmb3IobGV0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgIGRlbGV0ZSBkYXRhW2l0ZW1dO1xuICAgIH1cbiAgICB1cGRhdGVTdG9yZShkYXRhKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBzdG9yZTsiXSwic291cmNlUm9vdCI6IiJ9